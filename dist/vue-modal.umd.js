(function(e,d){typeof exports=="object"&&typeof module!="undefined"?module.exports=d(require("vue")):typeof define=="function"&&define.amd?define(["vue"],d):(e=typeof globalThis!="undefined"?globalThis:e||self,e.VueModal=d(e.Vue))})(this,function(e){"use strict";var d="",m=(t,s)=>{const l=t.__vccOpts||t;for(const[o,i]of s)l[o]=i;return l};const a={type:[String,Object,Array],default:""},f='a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])';let c=0;const u={name:"VueModal",props:{title:{type:String,default:""},baseZindex:{type:Number,default:1051},bgClass:a,wrapperClass:a,modalClass:a,modalStyle:a,inClass:Object.assign({},a,{default:"vm-fadeIn"}),outClass:Object.assign({},a,{default:"vm-fadeOut"}),bgInClass:Object.assign({},a,{default:"vm-fadeIn"}),bgOutClass:Object.assign({},a,{default:"vm-fadeOut"}),appendTo:{type:String,default:"body"},live:{type:Boolean,default:!1},enableClose:{type:Boolean,default:!0},modelValue:{type:Boolean,default:!1},closeLabel:{type:String,default:"Close"}},emits:["before-open","opening","after-open","before-close","closing","after-close","update:modelValue"],data(){return{zIndex:0,id:null,show:!1,mount:!1,elToFocus:null}},created(){this.live&&(this.mount=!0)},mounted(){this.id="vm-"+this.$.uid,this.$watch("modelValue",function(t){t?(this.mount=!0,this.$nextTick(()=>{this.show=!0})):this.show=!1},{immediate:!0})},beforeUnmount(){this.elToFocus=null},methods:{close(){this.enableClose===!0&&this.$emit("update:modelValue",!1)},clickOutside(t){t.target===this.$refs["vm-wrapper"]&&this.close()},keydown(t){if((t.which===27||t.keyCode===27)&&this.close(),t.which===9||t.keyCode===9){const s=[].slice.call(this.$refs["vm-wrapper"].querySelectorAll(f)).filter(function(l){return!!(l.offsetWidth||l.offsetHeight||l.getClientRects().length)});t.shiftKey?(t.target===s[0]||t.target===this.$refs["vm-wrapper"])&&(t.preventDefault(),s[s.length-1].focus()):t.target===s[s.length-1]&&(t.preventDefault(),s[0].focus())}},getAllVisibleWrappers(){return[].slice.call(document.querySelectorAll("[data-vm-wrapper-id]")).filter(t=>t.display!=="none")},getTopZindex(){return this.getAllVisibleWrappers().reduce((t,s)=>parseInt(s.style.zIndex)>t?parseInt(s.style.zIndex):t,0)},handleFocus(t){const s=t.querySelector("[autofocus]");if(s)s.focus();else{const l=t.querySelectorAll(f);l.length?l[0].focus():t.focus()}},beforeOpen(){this.elToFocus=document.activeElement;const t=this.getTopZindex();c?this.zIndex=c+2:this.zIndex=t===0?this.baseZindex:t+2,c=this.zIndex,this.$emit("before-open")},opening(){this.$emit("opening")},afterOpen(){this.handleFocus(this.$refs["vm-wrapper"]),this.$emit("after-open")},beforeClose(){this.$emit("before-close")},closing(){this.$emit("closing")},afterClose(){this.zIndex=0,this.live||(this.mount=!1),this.$nextTick(()=>{window.requestAnimationFrame(()=>{const t=this.getTopZindex();if(t>0){const s=this.getAllVisibleWrappers();for(let l=0;l<s.length;l++){const o=s[l];if(parseInt(o.style.zIndex)===t){o.contains(this.elToFocus)?this.elToFocus.focus():this.handleFocus(o);break}}}else document.body.contains(this.elToFocus)&&this.elToFocus.focus();c=0,this.$emit("after-close")})})}}},h=["data-vm-backdrop-id"],b=["data-vm-wrapper-id","aria-label","aria-describedby","aria-labelledby"],p=["data-vm-id"],y={class:"vm-titlebar"},g=["id"],v=["aria-label"],C=["id"];function w(t,s,l,o,i,n){return i.mount?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:l.appendTo},[e.createVNode(e.Transition,{name:"vm-backdrop-transition","enter-active-class":l.bgInClass,"leave-active-class":l.bgOutClass},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{"data-vm-backdrop-id":i.id,class:e.normalizeClass(["vm-backdrop",l.bgClass]),style:e.normalizeStyle({"z-index":i.zIndex-1})},null,14,h),[[e.vShow,i.show]])]),_:1},8,["enter-active-class","leave-active-class"]),e.createVNode(e.Transition,{name:"vm-transition","enter-active-class":l.inClass,"leave-active-class":l.outClass,onBeforeEnter:n.beforeOpen,onEnter:n.opening,onAfterEnter:n.afterOpen,onBeforeLeave:n.beforeClose,onLeave:n.closing,onAfterLeave:n.afterClose},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref:"vm-wrapper","data-vm-wrapper-id":i.id,tabindex:"-1",class:e.normalizeClass(["vm-wrapper",l.wrapperClass]),style:e.normalizeStyle({"z-index":i.zIndex,cursor:l.enableClose?"pointer":"default"}),role:"dialog","aria-label":l.title,"aria-modal":"true","aria-describedby":`${i.id}-content`,"aria-labelledby":`${i.id}-title`,onClick:s[1]||(s[1]=r=>n.clickOutside(r)),onKeydown:s[2]||(s[2]=r=>n.keydown(r))},[e.createElementVNode("div",{ref:"vm",class:e.normalizeClass(["vm",l.modalClass]),"data-vm-id":i.id,style:e.normalizeStyle(l.modalStyle)},[e.renderSlot(t.$slots,"titlebar",{},()=>[e.createElementVNode("div",y,[e.createElementVNode("h3",{id:`${i.id}-title`,class:"vm-title"},e.toDisplayString(l.title),9,g),l.enableClose?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:"vm-btn-close","aria-label":l.closeLabel,onClick:s[0]||(s[0]=e.withModifiers((...r)=>n.close&&n.close(...r),["prevent"]))},null,8,v)):e.createCommentVNode("",!0)])]),e.renderSlot(t.$slots,"content",{},()=>[e.createElementVNode("div",{id:`${i.id}-content`,class:"vm-content"},[e.renderSlot(t.$slots,"default")],8,C)])],14,p)],46,b),[[e.vShow,i.show]])]),_:3},8,["enter-active-class","leave-active-class","onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])],8,["to"])):e.createCommentVNode("",!0)}var x=m(u,[["render",w]]);return x});
