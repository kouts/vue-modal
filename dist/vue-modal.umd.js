(function(e,d){typeof exports=="object"&&typeof module<"u"?module.exports=d(require("vue")):typeof define=="function"&&define.amd?define(["vue"],d):(e=typeof globalThis<"u"?globalThis:e||self,e.VueModal=d(e.Vue))})(this,function(e){"use strict";const d="",m=(t,l)=>{const s=t.__vccOpts||t;for(const[a,i]of l)s[a]=i;return s},o={type:[String,Object,Array],default:""},f='a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])';let c=0;const u={name:"VueModal",props:{title:{type:String,default:""},baseZindex:{type:Number,default:1051},bgClass:o,wrapperClass:o,modalClass:o,modalStyle:o,inClass:Object.assign({},o,{default:"vm-fadeIn"}),outClass:Object.assign({},o,{default:"vm-fadeOut"}),bgInClass:Object.assign({},o,{default:"vm-fadeIn"}),bgOutClass:Object.assign({},o,{default:"vm-fadeOut"}),appendTo:{type:String,default:"body"},live:{type:Boolean,default:!1},enableClose:{type:Boolean,default:!0},modelValue:{type:Boolean,default:!1},closeLabel:{type:String,default:"Close"}},emits:["before-open","opening","after-open","before-close","closing","after-close","update:modelValue"],data(){return{zIndex:0,id:null,show:!1,mount:!1,elToFocus:null}},created(){this.live&&(this.mount=!0)},mounted(){this.id="vm-"+this.$.uid,this.$watch("modelValue",function(t){t?(this.mount=!0,this.$nextTick(()=>{this.show=!0})):this.show=!1},{immediate:!0})},beforeUnmount(){this.elToFocus=null},methods:{close(){this.enableClose===!0&&this.$emit("update:modelValue",!1)},clickOutside(t){t.target===this.$refs["vm-wrapper"]&&this.close()},keydown(t){if((t.which===27||t.keyCode===27)&&this.close(),t.which===9||t.keyCode===9){const l=[].slice.call(this.$refs["vm-wrapper"].querySelectorAll(f)).filter(function(s){return!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length)});t.shiftKey?(t.target===l[0]||t.target===this.$refs["vm-wrapper"])&&(t.preventDefault(),l[l.length-1].focus()):t.target===l[l.length-1]&&(t.preventDefault(),l[0].focus())}},getAllVisibleWrappers(){return[].slice.call(document.querySelectorAll("[data-vm-wrapper-id]")).filter(t=>t.display!=="none")},getTopZindex(){return this.getAllVisibleWrappers().reduce((t,l)=>parseInt(l.style.zIndex)>t?parseInt(l.style.zIndex):t,0)},handleFocus(t){const l=t.querySelector("[autofocus]");if(l)l.focus();else{const s=t.querySelectorAll(f);s.length?s[0].focus():t.focus()}},beforeOpen(){this.elToFocus=document.activeElement;const t=this.getTopZindex();c?this.zIndex=c+2:this.zIndex=t===0?this.baseZindex:t+2,c=this.zIndex,this.$emit("before-open")},opening(){this.$emit("opening")},afterOpen(){this.handleFocus(this.$refs["vm-wrapper"]),this.$emit("after-open")},beforeClose(){this.$emit("before-close")},closing(){this.$emit("closing")},afterClose(){this.zIndex=0,this.live||(this.mount=!1),this.$nextTick(()=>{window.requestAnimationFrame(()=>{const t=this.getTopZindex();if(t>0){const l=this.getAllVisibleWrappers();for(let s=0;s<l.length;s++){const a=l[s];if(parseInt(a.style.zIndex)===t){a.contains(this.elToFocus)?this.elToFocus.focus():this.handleFocus(a);break}}}else document.body.contains(this.elToFocus)&&this.elToFocus.focus();c=0,this.$emit("after-close")})})}}},h=["data-vm-backdrop-id"],b=["data-vm-wrapper-id","aria-label","aria-describedby","aria-labelledby"],p=["data-vm-id"],y={class:"vm-titlebar"},g=["id"],C=["aria-label"],v=["id"];function w(t,l,s,a,i,n){return i.mount?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:s.appendTo},[e.createVNode(e.Transition,{name:"vm-backdrop-transition","enter-active-class":s.bgInClass,"leave-active-class":s.bgOutClass},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{"data-vm-backdrop-id":i.id,class:e.normalizeClass(["vm-backdrop",s.bgClass]),style:e.normalizeStyle({"z-index":i.zIndex-1})},null,14,h),[[e.vShow,i.show]])]),_:1},8,["enter-active-class","leave-active-class"]),e.createVNode(e.Transition,{name:"vm-transition","enter-active-class":s.inClass,"leave-active-class":s.outClass,onBeforeEnter:n.beforeOpen,onEnter:n.opening,onAfterEnter:n.afterOpen,onBeforeLeave:n.beforeClose,onLeave:n.closing,onAfterLeave:n.afterClose},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref:"vm-wrapper","data-vm-wrapper-id":i.id,tabindex:"-1",class:e.normalizeClass(["vm-wrapper",s.wrapperClass]),style:e.normalizeStyle({"z-index":i.zIndex,cursor:s.enableClose?"pointer":"default"}),role:"dialog","aria-label":s.title,"aria-modal":"true","aria-describedby":`${i.id}-content`,"aria-labelledby":`${i.id}-title`,onClick:l[1]||(l[1]=r=>n.clickOutside(r)),onKeydown:l[2]||(l[2]=r=>n.keydown(r))},[e.createElementVNode("div",{ref:"vm",class:e.normalizeClass(["vm",s.modalClass]),"data-vm-id":i.id,style:e.normalizeStyle(s.modalStyle)},[e.renderSlot(t.$slots,"titlebar",{},()=>[e.createElementVNode("div",y,[e.createElementVNode("h3",{id:`${i.id}-title`,class:"vm-title"},e.toDisplayString(s.title),9,g),s.enableClose?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:"vm-btn-close","aria-label":s.closeLabel,onClick:l[0]||(l[0]=e.withModifiers((...r)=>n.close&&n.close(...r),["prevent"]))},null,8,C)):e.createCommentVNode("",!0)])]),e.renderSlot(t.$slots,"content",{},()=>[e.createElementVNode("div",{id:`${i.id}-content`,class:"vm-content"},[e.renderSlot(t.$slots,"default")],8,v)])],14,p)],46,b),[[e.vShow,i.show]])]),_:3},8,["enter-active-class","leave-active-class","onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])],8,["to"])):e.createCommentVNode("",!0)}return m(u,[["render",w]])});
